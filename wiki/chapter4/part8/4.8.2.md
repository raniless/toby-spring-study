# 4.8.2 \<url:resource/>를 이용한 리소스 관리
- 스프링 3.0.4에서 추가된 \<url:resource />를 활용하면 정적 파일로 구성된 리소스도 손쉽게 모듈화해서 사용할 수 있다.
- 모듈화하기 가장 좋은 방법은 jar 파일로 패키징 하는것이다.
- 예를 들어 다음과 같이 폴더 구조를 만들어 리소스 파일을 넣고 ui.jar로 패키징한 후 이를 사용할 웹 프로젝트의 라이브러리 폴더(/WEB-INF/lib)에 넣는다.
  ```
  META-INF
    +--webresources
      +--ui
        +--js
        +--css
        +--theme
  ```
- 이제 /ui라는 URL 요청이 들어왔을 때 클래스패스로만 접근 가능한 ui.jar 안의 내용이 사용되도록 서블릿 컨텍스트용 XML 안에 다음 한 줄만 넣어주면 된다.
  ```xml
  <mvc:resources mapping="/ui/**" location="classpath:/META-INF/webresources/" />
  ```
- 이렇게 해두면 /ui로 시작되는 요청이 들어왔을 때 이를 클래스패스 /META-INF/webresources 아래의 파일로 매핑해주는 핸들러가 등록된다.
  간단하면서도 매우 강력한 기능을 가진 URL 매핑 전략이다.
- location 애트리뷰트는 스프링의 리소스를 기술하는 어떤 내용이 나와도 좋다.
  file: 접두어를 사용하면 서버의 로컬 폴더에 매핑할 수도 있다. http:를 쓰면 네트워크를 통해 다른 서버의 내용을 가져오게 할 수도 있다.
  아무런 접두어를 붙이지 않으면 서블릿 컨텍스트 리소스가 되므로 웹 콘텐트 폴더의 내용을 그대로 매핑하게 해준다.
- /ui로 들어오는 요청을 /ui-ver2에 매핑하게 하려면 다음과 같이 해주면 된다.
  ```xml
  <mvc:resources mapping="/ui/**" locations="/ui-ver2/" />
  ```
- 정적 리소스를 모듈화해서 jar 파일에 담아 사용하게 하는 것 외에도 다양한 응용 방법을 생각할 수 있을 것이다.
- \<mvc:resources>에 의해 등록되는 핸들러는 디폴트 서블릿 기능과 유사하다.
- 브라우저의 캐시가 효과적으로 사용되게 하려면 같은 정적 리소스에 대한 요청이 반복될때 매번 리소스 파일을 읽어서 보내주는 대신
  리소스 내용이 바뀌지 않았다는 HTTP 304 Not Modified 응답을 보내줘야 한다.
- 정적 리소스이므로 내용이 바뀌지 않았는데도 매번 보내는 것은 서버와 네트워크 자원의 낭비고 성능을 떨어뜨린다.
- 그래서 디폴트 서블릿과 같이 정적 리소스를 다루는 서블릿에서는 이 304 응답 코드를 활용해 응답을 해주는 것이 중요하다.
- \<mvc:resources>에 의해 등록되는 핸들러도 304 응답 코드를 처리하는 기능을 갖고 있다. 따라서 정적 파일을 최적화된 방식으로 다룰 수 있게 해준다.
- \<mvc:resources>를 등록해서 모든 정적 리소스를 담당하게 한다면 굳이 디폴트 서블릿이 사용될 필요가 없으니 DispatcherServlet을 /에 매핑하더라도
  \<mvc:default-servlet-handler>를 사용할 필요가 없다.
- 하지만 일부 모듈화가 필요한 리소스만 \<mvc:resources>로 매핑하고 해당 애플리케이션에서만 사용되는 웹 리소스는 
  디폴트 서블릿이 담당하게 한다면 \<mvc:default-servlet-handler>를 함께 사용하는 것이 편리하다.
- \<mvc:resources>는 \<mvc:default-servlet-handler>보다 매핑 우선순위가 높다.
  따라서 \<mvc:resources>로 매핑이 안되는 요청만 디폴트 서블릿으로 포워딩될 것이다.